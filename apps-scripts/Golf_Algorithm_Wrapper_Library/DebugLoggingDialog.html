<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 16px;
        color: #202124;
      }
      .row {
        margin: 12px 0;
      }
      .actions {
        display: flex;
        gap: 8px;
        margin-top: 16px;
      }
      button {
        padding: 6px 12px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      .primary {
        background: #1a73e8;
        color: #fff;
      }
      .secondary {
        background: #e0e0e0;
      }
    </style>
  </head>
  <body>
    <div class="row">
      <label>
        <input type="checkbox" id="debugEnabled" />
        Enable debug logging (write both debug sheets)
      </label>
    </div>

    <div class="actions">
      <button class="primary" onclick="saveSettings()">Save</button>
      <button class="secondary" onclick="google.script.host.close()">Cancel</button>
    </div>

    <script>
      function loadSettings() {
        google.script.run
          .withSuccessHandler(function(data) {
            document.getElementById('debugEnabled').checked = !!(data && data.enabled);
          })
          .withFailureHandler(function(err) {
            alert('Load failed: ' + (err && err.message ? err.message : err));
          })
          .getDebugLoggingSettings();
      }

      function saveSettings() {
        const enabled = document.getElementById('debugEnabled').checked;
        google.script.run
          .withSuccessHandler(function() {
            google.script.host.close();
          })
          .withFailureHandler(function(err) {
            alert('Save failed: ' + (err && err.message ? err.message : err));
          })
          .setDebugLoggingSettings(enabled);
      }

      loadSettings();
    </script>
  </body>
</html>
